<configuration>
  <include resource="org/springframework/boot/logging/logback/defaults.xml"/>
  <include resource="org/springframework/boot/logging/logback/console-appender.xml" />

  <springProperty scope="context" name="appname" source="spring.application.name"/>
  <springProperty scope="context" name="profile" source="spring.profiles.active"/>

  <property name="CONSOLE_LOG_PATTERN_TRACING"
            value="%clr(%d{\${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}){faint} %clr(\${LOG_LEVEL_PATTERN:-%5p}) %clr([%X{trace.id}:%X{span.id}]) %clr(\${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n\${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}"/>

  <appender name="console-appender" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <pattern>\${CONSOLE_LOG_PATTERN_TRACING}</pattern>
    </encoder>
  </appender>

  $if(technicaltrace_enable.truthy)$
  <appender name="console-appender-logstash" class="ch.qos.logback.core.ConsoleAppender">
    <encoder class="net.logstash.logback.encoder.LogstashEncoder">
      <customFields>{"appname":"\${appname}", "profile":"\${profile}"}</customFields>
    </encoder>
  </appender>
  $endif$

  <root level="INFO">
    <appender-ref ref="console-appender"/>
    $if(technicaltrace_enable.truthy)$
    <!--<appender-ref ref="console-appender-logstash"/>-->
    $endif$
  </root>
  <logger name="pe.talma" level="TRACE"/>

</configuration>
